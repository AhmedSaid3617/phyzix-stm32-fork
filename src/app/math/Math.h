//
// Created by shams on 8/8/24.
//

#ifndef PHYZIX_MATH_H
#define PHYZIX_MATH_H


class Math{
public:
    static constexpr float PI = 3.141592653589793;

    static float pow(float base, int exponent) {
        float result = 1;

        if (exponent > 0)
            while (exponent--)
                result *= base;
        else if (exponent < 0)
            while (exponent++)
                result /= base;

        return result;
    }

    static float min(float a, float b) {
        return a > b ? b : a;
    }

    static float max(float a, float b) {
        return a > b ? a : b;
    }

    static float fabs(float n) {
        return n < 0 ? -n : n;
    }

    static float sqrt(float n) {
        if (n == 0) return 0;

        double x = n;
        double y = 1.0;
        double epsilon = 0.000001; // Desired precision

        while (fabs(x - y) > epsilon) {
            x = (x + y) / 2;
            y = n / x;
        }

        return x;
    }

    static float cos(float angle) {
        angle = fabs(angle);
        while (angle >= 2 * PI)
            angle -= 2 * PI;

//        if (angle >= PI)
//            return cos(angle - PI);
//
//        if (angle >= PI / 2)
//            return -cos(angle - PI/2);

        return cosine[(int) (0.5 + 500 * angle / (2 * PI))];
    }

    static float sin(float angle) {
        return cos(angle - PI/2);
    }

private:
    static constexpr float cosine[500] = {
            1.0,
            0.9999210442038161,
            0.9996841892832999,
            0.9992894726405892,
            0.9987369566060175,
            0.9980267284282716,
            0.9971589002606139,
            0.9961336091431725,
            0.9949510169813002,
            0.9936113105200084,
            0.9921147013144779,
            0.9904614256966512,
            0.9886517447379141,
            0.986685944207868,
            0.9845643345292053,
            0.9822872507286887,
            0.9798550523842469,
            0.9772681235681935,
            0.9745268727865771,
            0.971631732914674,
            0.9685831611286311,
            0.9653816388332739,
            0.9620276715860859,
            0.9585217890173758,
            0.954864544746643,
            0.9510565162951535,
            0.9470983049947443,
            0.9429905358928645,
            0.9387338576538741,
            0.934328942456612,
            0.9297764858882515,
            0.925077206834458,
            0.9202318473658704,
            0.9152411726209175,
            0.9101059706849957,
            0.9048270524660195,
            0.8994052515663711,
            0.8938414241512638,
            0.8881364488135446,
            0.8822912264349533,
            0.8763066800438636,
            0.8701837546695257,
            0.8639234171928353,
            0.8575266561936523,
            0.850994481794692,
            0.8443279255020151,
            0.8375280400421418,
            0.8305958991958127,
            0.8235325976284275,
            0.8163392507171839,
            0.8090169943749475,
            0.8015669848708766,
            0.7939903986478354,
            0.7862884321366189,
            0.7784623015670235,
            0.7705132427757893,
            0.7624425110114479,
            0.7542513807361038,
            0.7459411454241821,
            0.7375131173581739,
            0.7289686274214116,
            0.7203090248879069,
            0.7115356772092855,
            0.7026499697988492,
            0.6936533058128049,
            0.6845471059286886,
            0.6753328081210245,
            0.6660118674342517,
            0.6565857557529564,
            0.6470559615694443,
            0.6374239897486896,
            0.6276913612907006,
            0.6178596130903344,
            0.6079302976946055,
            0.5979049830575189,
            0.5877852522924731,
            0.5775727034222676,
            0.5672689491267565,
            0.5568756164881881,
            0.5463943467342691,
            0.5358267949789965,
            0.5251746299612957,
            0.5144395337815064,
            0.5036232016357609,
            0.49272734154829156,
            0.48175367410171516,
            0.47070393216533274,
            0.4595798606214879,
            0.44838321609003245,
            0.437115766650933,
            0.42577929156507266,
            0.41437558099328425,
            0.4029064357136627,
            0.39137366683720254,
            0.3797790955218011,
            0.3681245526846781,
            0.35641187871325075,
            0.344642923174517,
            0.3328195445229867,
            0.32094360980720943,
            0.30901699437494745,
            0.29704158157703486,
            0.28501926246997616,
            0.2729519355173254,
            0.260841506289897,
            0.24868988716485496,
            0.23649899702372476,
            0.22427076094938117,
            0.21200710992205474,
            0.199709980514407,
            0.18738131458572474,
            0.17502305897527604,
            0.16263716519488372,
            0.15022558912075706,
            0.13779029068463797,
            0.12533323356430426,
            0.1128563848734816,
            0.10036171485121491,
            0.08785119655074332,
            0.07532680552793275,
            0.06279051952931353,
            0.0502443181797696,
            0.037690182669934694,
            0.02513009544333753,
            0.012566039883352776,
            6.123233995736766e-17,
            -0.012566039883352653,
            -0.025130095443337407,
            -0.037690182669934576,
            -0.05024431817976947,
            -0.0627905195293134,
            -0.07532680552793262,
            -0.0878511965507432,
            -0.100361714851215,
            -0.1128563848734817,
            -0.12533323356430437,
            -0.13779029068463805,
            -0.15022558912075715,
            -0.16263716519488358,
            -0.17502305897527615,
            -0.18738131458572482,
            -0.1997099805144069,
            -0.2120071099220544,
            -0.22427076094938103,
            -0.23649899702372443,
            -0.24868988716485463,
            -0.26084150628989666,
            -0.27295193551732505,
            -0.28501926246997605,
            -0.29704158157703475,
            -0.30901699437494734,
            -0.3209436098072093,
            -0.33281954452298657,
            -0.3446429231745169,
            -0.35641187871325064,
            -0.368124552684678,
            -0.379779095521801,
            -0.3913736668372024,
            -0.4029064357136626,
            -0.41437558099328414,
            -0.4257792915650727,
            -0.4371157666509327,
            -0.4483832160900321,
            -0.4595798606214878,
            -0.47070393216533263,
            -0.48175367410171543,
            -0.49272734154829145,
            -0.5036232016357608,
            -0.5144395337815065,
            -0.5251746299612958,
            -0.5358267949789969,
            -0.546394346734269,
            -0.5568756164881876,
            -0.5672689491267563,
            -0.5775727034222674,
            -0.587785252292473,
            -0.5979049830575185,
            -0.6079302976946052,
            -0.6178596130903342,
            -0.6276913612907004,
            -0.6374239897486897,
            -0.647055961569444,
            -0.6565857557529563,
            -0.6660118674342516,
            -0.6753328081210245,
            -0.6845471059286887,
            -0.6936533058128048,
            -0.7026499697988491,
            -0.7115356772092853,
            -0.7203090248879069,
            -0.7289686274214113,
            -0.7375131173581738,
            -0.7459411454241821,
            -0.7542513807361039,
            -0.762442511011448,
            -0.7705132427757891,
            -0.7784623015670233,
            -0.7862884321366189,
            -0.7939903986478354,
            -0.8015669848708767,
            -0.8090169943749473,
            -0.8163392507171839,
            -0.8235325976284275,
            -0.8305958991958128,
            -0.8375280400421417,
            -0.8443279255020149,
            -0.8509944817946917,
            -0.8575266561936521,
            -0.8639234171928353,
            -0.8701837546695257,
            -0.8763066800438634,
            -0.8822912264349532,
            -0.8881364488135445,
            -0.8938414241512638,
            -0.8994052515663711,
            -0.9048270524660194,
            -0.9101059706849957,
            -0.9152411726209175,
            -0.9202318473658704,
            -0.9250772068344579,
            -0.9297764858882513,
            -0.934328942456612,
            -0.9387338576538741,
            -0.9429905358928645,
            -0.9470983049947442,
            -0.9510565162951535,
            -0.954864544746643,
            -0.958521789017376,
            -0.9620276715860859,
            -0.9653816388332739,
            -0.9685831611286311,
            -0.971631732914674,
            -0.9745268727865772,
            -0.9772681235681935,
            -0.9798550523842469,
            -0.9822872507286886,
            -0.9845643345292053,
            -0.986685944207868,
            -0.988651744737914,
            -0.9904614256966512,
            -0.9921147013144778,
            -0.9936113105200084,
            -0.9949510169813002,
            -0.9961336091431725,
            -0.9971589002606139,
            -0.9980267284282716,
            -0.9987369566060175,
            -0.9992894726405892,
            -0.9996841892832999,
            -0.9999210442038161,
            -1.0,
            -0.9999210442038161,
            -0.9996841892832999,
            -0.9992894726405892,
            -0.9987369566060175,
            -0.9980267284282716,
            -0.9971589002606139,
            -0.9961336091431725,
            -0.9949510169813002,
            -0.9936113105200084,
            -0.9921147013144779,
            -0.9904614256966512,
            -0.9886517447379141,
            -0.986685944207868,
            -0.9845643345292053,
            -0.9822872507286886,
            -0.9798550523842469,
            -0.9772681235681935,
            -0.9745268727865771,
            -0.9716317329146739,
            -0.9685831611286311,
            -0.9653816388332739,
            -0.9620276715860859,
            -0.9585217890173758,
            -0.954864544746643,
            -0.9510565162951535,
            -0.9470983049947443,
            -0.9429905358928644,
            -0.9387338576538741,
            -0.9343289424566119,
            -0.9297764858882512,
            -0.925077206834458,
            -0.9202318473658705,
            -0.9152411726209179,
            -0.9101059706849959,
            -0.9048270524660197,
            -0.8994052515663712,
            -0.8938414241512641,
            -0.8881364488135448,
            -0.8822912264349535,
            -0.8763066800438637,
            -0.8701837546695258,
            -0.8639234171928356,
            -0.8575266561936525,
            -0.8509944817946921,
            -0.8443279255020152,
            -0.8375280400421418,
            -0.8305958991958129,
            -0.8235325976284277,
            -0.816339250717184,
            -0.8090169943749476,
            -0.8015669848708769,
            -0.7939903986478356,
            -0.786288432136619,
            -0.7784623015670236,
            -0.7705132427757893,
            -0.7624425110114481,
            -0.754251380736104,
            -0.7459411454241822,
            -0.7375131173581739,
            -0.7289686274214116,
            -0.7203090248879072,
            -0.7115356772092855,
            -0.7026499697988493,
            -0.6936533058128049,
            -0.684547105928689,
            -0.6753328081210246,
            -0.6660118674342517,
            -0.6565857557529564,
            -0.6470559615694442,
            -0.6374239897486895,
            -0.6276913612907002,
            -0.6178596130903348,
            -0.6079302976946057,
            -0.597904983057519,
            -0.5877852522924732,
            -0.5775727034222676,
            -0.5672689491267564,
            -0.5568756164881878,
            -0.5463943467342689,
            -0.5358267949789963,
            -0.5251746299612953,
            -0.5144395337815068,
            -0.503623201635761,
            -0.4927273415482917,
            -0.48175367410171527,
            -0.47070393216533246,
            -0.45957986062148765,
            -0.44838321609003196,
            -0.4371157666509325,
            -0.42577929156507216,
            -0.41437558099328436,
            -0.4029064357136628,
            -0.3913736668372024,
            -0.37977909552180183,
            -0.3681245526846786,
            -0.35641187871325125,
            -0.3446429231745175,
            -0.332819544522987,
            -0.32094360980720976,
            -0.30901699437494756,
            -0.297041581577035,
            -0.28501926246997694,
            -0.27295193551732594,
            -0.26084150628989755,
            -0.2486898871648553,
            -0.2364989970237251,
            -0.2242707609493815,
            -0.21200710992205485,
            -0.1997099805144071,
            -0.18738131458572463,
            -0.17502305897527595,
            -0.16263716519488428,
            -0.15022558912075762,
            -0.13779029068463852,
            -0.1253332335643046,
            -0.11285638487348193,
            -0.10036171485121503,
            -0.08785119655074321,
            -0.07532680552793265,
            -0.06279051952931321,
            -0.05024431817977017,
            -0.03769018266993504,
            -0.025130095443337875,
            -0.012566039883352897,
            -1.8369701987210297e-16,
            0.012566039883352531,
            0.025130095443337507,
            0.03769018266993467,
            0.0502443181797698,
            0.06279051952931283,
            0.07532680552793229,
            0.08785119655074285,
            0.10036171485121467,
            0.11285638487348157,
            0.12533323356430423,
            0.13779029068463816,
            0.15022558912075726,
            0.16263716519488391,
            0.1750230589752756,
            0.18738131458572427,
            0.19970998051440675,
            0.2120071099220545,
            0.22427076094938114,
            0.23649899702372473,
            0.24868988716485493,
            0.2608415062898972,
            0.2729519355173256,
            0.2850192624699766,
            0.29704158157703464,
            0.30901699437494723,
            0.32094360980720943,
            0.3328195445229867,
            0.34464292317451717,
            0.3564118787132509,
            0.36812455268467825,
            0.3797790955218015,
            0.3913736668372021,
            0.40290643571366247,
            0.41437558099328403,
            0.4257792915650718,
            0.43711576665093216,
            0.4483832160900316,
            0.4595798606214873,
            0.47070393216533213,
            0.48175367410171493,
            0.49272734154829134,
            0.5036232016357607,
            0.5144395337815064,
            0.5251746299612949,
            0.535826794978996,
            0.5463943467342686,
            0.5568756164881876,
            0.5672689491267562,
            0.5775727034222673,
            0.5877852522924729,
            0.5979049830575188,
            0.6079302976946054,
            0.6178596130903344,
            0.6276913612906999,
            0.6374239897486893,
            0.647055961569444,
            0.6565857557529562,
            0.6660118674342514,
            0.6753328081210244,
            0.6845471059286886,
            0.693653305812805,
            0.7026499697988493,
            0.7115356772092849,
            0.7203090248879065,
            0.7289686274214112,
            0.7375131173581737,
            0.745941145424182,
            0.7542513807361038,
            0.7624425110114479,
            0.7705132427757894,
            0.7784623015670236,
            0.7862884321366186,
            0.793990398647835,
            0.8015669848708764,
            0.8090169943749473,
            0.8163392507171839,
            0.8235325976284275,
            0.8305958991958127,
            0.8375280400421419,
            0.8443279255020153,
            0.8509944817946921,
            0.8575266561936521,
            0.8639234171928352,
            0.8701837546695256,
            0.8763066800438636,
            0.8822912264349533,
            0.8881364488135446,
            0.8938414241512639,
            0.8994052515663712,
            0.9048270524660197,
            0.9101059706849955,
            0.9152411726209175,
            0.9202318473658703,
            0.9250772068344577,
            0.9297764858882511,
            0.9343289424566118,
            0.9387338576538738,
            0.9429905358928643,
            0.9470983049947441,
            0.9510565162951535,
            0.954864544746643,
            0.9585217890173756,
            0.9620276715860857,
            0.9653816388332737,
            0.968583161128631,
            0.9716317329146739,
            0.974526872786577,
            0.9772681235681934,
            0.9798550523842469,
            0.9822872507286887,
            0.9845643345292054,
            0.9866859442078679,
            0.988651744737914,
            0.9904614256966512,
            0.9921147013144778,
            0.9936113105200084,
            0.9949510169813002,
            0.9961336091431725,
            0.9971589002606139,
            0.9980267284282716,
            0.9987369566060175,
            0.9992894726405892,
            0.9996841892832999,
            0.9999210442038161,
    } ;
};


#endif //PHYZIX_MATH_H
